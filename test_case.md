# Test Case: 게임 점수 기록 (Google Login)

**게임 점수 기록 기능**과 **Google 로그인** 연동을 검증하기 위한 테스트 가이드입니다.

## 사전 준비 (환경 변수 설정)

테스트를 위해서는 프로젝트 루트의 `.env` (또는 `.env.local`) 파일에 다음 설정이 필요합니다.

```env
AUTH_SECRET="임의의_문자열_생성_가능_혹은_openssl_rand_base64_32"
AUTH_GOOGLE_ID="구글_클라우드_콘솔에서_발급받은_Client_ID"
AUTH_GOOGLE_SECRET="구글_클라우드_콘솔에서_발급받은_Client_Secret"
```

## 테스트 시나리오

| 단계 | 상태         | 동작                               | 예상 결과                                                              |
| :--- | :----------- | :--------------------------------- | :--------------------------------------------------------------------- |
| 1    | **비로그인** | 게임 종료 화면 진입                | [공유하기] 버튼 아래 **[Google 로그인하고 기록하기]** (흰색 버튼) 표시 |
| 2    | **비로그인** | 버튼 클릭                          | Google 로그인 창 팝업 또는 리다이렉트                                  |
| 3    | **로그인**   | 로그인 완료 후 게임 종료 화면 복귀 | 버튼이 **[점수 기록하기]** (남색 버튼)로 변경됨                        |

### 4. 게임 점수 기록 (Google Login)

1. **로그인 상태 확인**
   - Result Screen에서 [점수 기록하기] 버튼이 "Google 로그인하고 기록하기"인지 "점수 기록하기"인지 확인.
2. **비로그인 점수 기록 (Persistence Test)**
   - 로그인이 안 된 상태에서 게임을 플레이하고 점수 획득.
   - [Google 로그인하고 기록하기] 버튼 클릭.
   - 구글 로그인 페이지로 이동 -> 로그인 진행.
   - **리다이렉트 후 게임 초기 화면이 아닌 Result Screen이 바로 뜨는지 확인.** (중요!)
   - 버튼이 "기록 중..." -> "기록 완료"로 자동 변경되거나, 활성화된 상태인지 확인.
3. **로그인 상태 점수 기록**
   - 이미 로그인된 상태에서 게임 플레이.
   - [점수 기록하기] 버튼 클릭.
   - 버튼 텍스트가 "기록 중..." -> "기록 완료"로 변경되는지 확인.
   - **Network 탭**에서 `https://api.icecoke.kr/game/result` 요청이 `201 Created`로 성공하는지 확인.

### 5. Google Site Verification

- 구글 서치 콘솔에서 **HTML 파일** 방식으로 소유권 확인 재시도 -> **성공** 메시지 확인.

## 참고 사항

- `.env` 설정 없이 버튼을 누르면 NextAuth 에러 페이지가 뜰 수 있습니다.
- Google 로그인은 실제 구글 계정으로 수행됩니다.
- 점수 제출은 여전히 Mock API입니다.
